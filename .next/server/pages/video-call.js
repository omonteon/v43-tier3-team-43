"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/video-call";
exports.ids = ["pages/video-call"];
exports.modules = {

/***/ "./pages/video-call/index.tsx":
/*!************************************!*\
  !*** ./pages/video-call/index.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VideoCall)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/app */ \"firebase/app\");\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(firebase_app__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(firebase_firestore__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/router */ \"next/router\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyBWs4xPin01JqGY7nqPJwr2cEGLUxhW0k4\",\n    authDomain: \"fir-rtc-add78.firebaseapp.com\",\n    projectId: \"fir-rtc-add78\",\n    storageBucket: \"fir-rtc-add78.appspot.com\",\n    messagingSenderId: \"364056915372\",\n    appId: \"1:364056915372:web:df2c52eec9f49d2fc9de09\"\n};\nif (!(firebase_app__WEBPACK_IMPORTED_MODULE_1___default().apps.length)) {\n    firebase_app__WEBPACK_IMPORTED_MODULE_1___default().initializeApp(firebaseConfig);\n}\nconst firestore = firebase_app__WEBPACK_IMPORTED_MODULE_1___default().firestore();\nfunction VideoCall() {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)();\n    const peerConnection = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n    const localVideoRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n    const remoteVideoRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n    const localStream = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n    const [cameraActive, setCameraActive] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(true);\n    const [micActive, setMicActive] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(true);\n    const [remoteCameraActive, setRemoteCameraActive] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n    const [callId, setCallId] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(router.query.id?.toString());\n    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{\n        const servers = {\n            iceServers: [\n                {\n                    urls: [\n                        \"stun:stun1.l.google.com:19302\",\n                        \"stun:stun2.l.google.com:19302\"\n                    ]\n                }\n            ],\n            iceCandidatePoolSize: 10\n        };\n        peerConnection.current = new RTCPeerConnection(servers);\n        startWebcam().then(()=>{\n            if (router.query.id) {\n                joinCall();\n            }\n        });\n        return ()=>{\n            // Cleanup function to be called when the component is unmounted\n            // 1. Stop all media tracks\n            if (localStream.current) {\n                localStream.current.getTracks().forEach((track)=>track.stop());\n            }\n            // 2. Close the RTCPeerConnection\n            if (peerConnection.current) {\n                peerConnection.current.close();\n            }\n        };\n    }, []);\n    // Setup media sources\n    const startWebcam = async ()=>{\n        const _localStream = await navigator.mediaDevices.getUserMedia({\n            video: true,\n            audio: true\n        });\n        const _remoteStream = new MediaStream();\n        // Push tracks from local stream to peer connection\n        _localStream.getTracks().forEach((track)=>{\n            peerConnection.current.addTrack(track, _localStream);\n        });\n        // Pull tracks from remote stream, add to video stream\n        peerConnection.current.ontrack = (event)=>{\n            event.streams[0].getTracks().forEach((track)=>{\n                _remoteStream.addTrack(track);\n                if (track.kind === \"video\") {\n                    // Handle video track mute/unmute events\n                    track.onmute = ()=>{\n                        console.log(\"Remote peer stopped their video\");\n                        setRemoteCameraActive(false);\n                    };\n                    track.onunmute = ()=>{\n                        console.log(\"Remote peer restarted their video\");\n                        setRemoteCameraActive(true);\n                    };\n                }\n            });\n        };\n        localVideoRef.current.srcObject = _localStream;\n        remoteVideoRef.current.srcObject = _remoteStream;\n        localStream.current = _localStream;\n    };\n    const toggleRemoteVideo = ()=>{\n        setRemoteCameraActive(!remoteCameraActive);\n    };\n    const toggleVideo = ()=>{\n        if (localVideoRef.current) {\n            const stream = localVideoRef.current.srcObject;\n            if (stream) {\n                const videoTracks = stream.getVideoTracks();\n                if (videoTracks.length > 0) {\n                    if (!cameraActive) {\n                        // Restart the video\n                        navigator.mediaDevices.getUserMedia({\n                            video: true\n                        }).then((newStream)=>{\n                            const newVideoTrack = newStream.getVideoTracks()[0];\n                            const sender = peerConnection.current.getSenders().find((s)=>{\n                                return s.track && s.track.kind === \"video\";\n                            });\n                            sender.replaceTrack(newVideoTrack);\n                            stream.removeTrack(videoTracks[0]);\n                            stream.addTrack(newVideoTrack);\n                            setCameraActive(true);\n                        }).catch((err)=>console.error(\"Error restarting video:\", err));\n                    } else {\n                        // Stop the video and the connection with the camera\n                        videoTracks[0].stop();\n                        setCameraActive(false);\n                    }\n                }\n            }\n        }\n    };\n    const toggleMic = ()=>{\n        setMicActive(!micActive);\n        if (localVideoRef.current) {\n            const stream = localVideoRef.current.srcObject;\n            if (stream) {\n                const audioTracks = stream.getAudioTracks();\n                if (audioTracks.length > 0) {\n                    audioTracks[0].enabled = !audioTracks[0].enabled;\n                }\n            }\n        }\n    };\n    // Create an offer\n    const createCallId = async ()=>{\n        // Reference Firestore collections for signaling\n        const callDoc = firestore.collection(\"calls\").doc();\n        const offerCandidates = callDoc.collection(\"offerCandidates\");\n        const answerCandidates = callDoc.collection(\"answerCandidates\");\n        setCallId(callDoc.id);\n        copyToClipboard(callDoc.id);\n        // Get candidates for caller, save to db\n        peerConnection.current.onicecandidate = (event)=>{\n            event.candidate && offerCandidates.add(event.candidate.toJSON());\n        };\n        // Create offer\n        const offerDescription = await peerConnection.current.createOffer();\n        await peerConnection.current.setLocalDescription(offerDescription);\n        const offer = {\n            sdp: offerDescription.sdp,\n            type: offerDescription.type\n        };\n        await callDoc.set({\n            offer\n        });\n        // Listen for remote answer\n        callDoc.onSnapshot((snapshot)=>{\n            const data = snapshot.data();\n            if (!peerConnection.current.currentRemoteDescription && data?.answer) {\n                const answerDescription = new RTCSessionDescription(data.answer);\n                peerConnection.current.setRemoteDescription(answerDescription);\n            }\n        });\n        // When answered, add candidate to peer connection\n        answerCandidates.onSnapshot((snapshot)=>{\n            snapshot.docChanges().forEach((change)=>{\n                if (change.type === \"added\") {\n                    const candidate = new RTCIceCandidate(change.doc.data());\n                    peerConnection.current.addIceCandidate(candidate);\n                }\n            });\n        });\n    };\n    // Answer the call with the unique id\n    const joinCall = async ()=>{\n        const callDoc = firestore.collection(\"calls\").doc(callId);\n        const answerCandidates = callDoc.collection(\"answerCandidates\");\n        const offerCandidates = callDoc.collection(\"offerCandidates\");\n        peerConnection.current.onicecandidate = (event)=>{\n            event.candidate && answerCandidates.add(event.candidate.toJSON());\n        };\n        const callData = (await callDoc.get()).data();\n        const offerDescription = callData.offer;\n        await peerConnection.current.setRemoteDescription(new RTCSessionDescription(offerDescription));\n        const answerDescription = await peerConnection.current.createAnswer();\n        await peerConnection.current.setLocalDescription(answerDescription);\n        const answer = {\n            type: answerDescription.type,\n            sdp: answerDescription.sdp\n        };\n        await callDoc.update({\n            answer\n        });\n        offerCandidates.onSnapshot((snapshot)=>{\n            snapshot.docChanges().forEach((change)=>{\n                if (change.type === \"added\") {\n                    let data = change.doc.data();\n                    peerConnection.current.addIceCandidate(new RTCIceCandidate(data));\n                }\n            });\n        });\n    };\n    const endCall = ()=>{\n        router.back();\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"white-grid flex flex-col items-center\",\n        children: [\n            router.query.id ? null : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex flex-col gap-2 mt-4\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                    className: `border-2 border-communixPurple rounded-md bg-communixRed py-2 px-4`,\n                    onClick: createCallId,\n                    children: \"Copy call ID\"\n                }, void 0, false, {\n                    fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                    lineNumber: 246,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                lineNumber: 245,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex flex-col justify-end relative left-80 top-32 gap-1\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: toggleMic,\n                        type: \"button\",\n                        className: \"border-2 border-communixPurple rounded-md bg-communixRed\",\n                        children: micActive ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                            src: \"/mic.png\",\n                            alt: \"toggle mic\",\n                            className: \"h-8 p-2 py-1\"\n                        }, void 0, false, {\n                            fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                            lineNumber: 261,\n                            columnNumber: 13\n                        }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                            src: \"/mute.png\",\n                            alt: \"toggle mic\",\n                            className: \"h-8 p-2 py-1\"\n                        }, void 0, false, {\n                            fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                            lineNumber: 263,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                        lineNumber: 255,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: endCall,\n                        type: \"button\",\n                        className: \"border-2 border-communixPurple rounded-md bg-communixRed\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                            src: \"/logout.png\",\n                            alt: \"leave chat\",\n                            className: \"h-8 p-2 py-1\"\n                        }, void 0, false, {\n                            fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                            lineNumber: 271,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                        lineNumber: 266,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: toggleVideo,\n                        type: \"button\",\n                        className: \"border-2 border-communixPurple rounded-md bg-communixRed\",\n                        children: cameraActive ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                            src: \"/video-camera.png\",\n                            alt: \"toggle camera\",\n                            className: \"h-8 p-2 py-1\"\n                        }, void 0, false, {\n                            fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                            lineNumber: 279,\n                            columnNumber: 13\n                        }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                            src: \"/no-video.png\",\n                            alt: \"toggle camera\",\n                            className: \"h-8 p-2 py-1\"\n                        }, void 0, false, {\n                            fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                            lineNumber: 285,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                        lineNumber: 273,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                lineNumber: 254,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"video\", {\n                autoPlay: true,\n                muted: true,\n                ref: localVideoRef,\n                className: cameraActive ? \"bg-white border-2 border-communixRed h-80 aspect-video\" : \"hidden\"\n            }, void 0, false, {\n                fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                lineNumber: 293,\n                columnNumber: 7\n            }, this),\n            !cameraActive && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-white flex flex-col justify-end items-center border-2 border-communixRed h-80 aspect-video\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                    src: \"/shy.png\",\n                    alt: \"shy person\",\n                    className: \"h-72\"\n                }, void 0, false, {\n                    fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                    lineNumber: 305,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                lineNumber: 304,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"h-80 aspect-video bg-communixGreen border-2 border-communixPurple flex justify-center items-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"video\", {\n                        autoPlay: true,\n                        ref: remoteVideoRef,\n                        className: `h-80 aspect-video bg-communixGreen border-2 border-communixPurple ${remoteCameraActive ? \"\" : \"hidden\"}`\n                    }, void 0, false, {\n                        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                        lineNumber: 310,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                        src: \"/shy2.png\",\n                        alt: \"your partner is shy too\",\n                        className: `h-72 rounded-full ${remoteCameraActive ? \"hidden\" : \"\"}`\n                    }, void 0, false, {\n                        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                        lineNumber: 317,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n                lineNumber: 309,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/omonteon/projects/chingu/voyage-43/fork/pages/video-call/index.tsx\",\n        lineNumber: 239,\n        columnNumber: 5\n    }, this);\n}\nfunction copyToClipboard(text) {\n    navigator.clipboard.writeText(text).then(function() {\n        alert(\"Id was copied successfully!\");\n    }, function(err) {\n        alert(\"Error: Could not copy id\");\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy92aWRlby1jYWxsL2luZGV4LnRzeC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFDb0M7QUFDUjtBQUN3QjtBQUNaO0FBRXhDLE1BQU1LLGlCQUFpQjtJQUNyQkMsUUFBUUMseUNBQStCO0lBQ3ZDRyxZQUFZSCwrQkFBbUM7SUFDL0NLLFdBQVdMLGVBQWtDO0lBQzdDTyxlQUFlUCwyQkFBc0M7SUFDckRTLG1CQUFtQlQsY0FBMkM7SUFDOURXLE9BQU9YLDJDQUE4QjtBQUN2QztBQUVBLElBQUksQ0FBQ1AsaUVBQW9CLEVBQUU7SUFDekJBLGlFQUFzQixDQUFDSztBQUN6QixDQUFDO0FBQ0QsTUFBTWtCLFlBQVl2Qiw2REFBa0I7QUFFckIsU0FBU3dCLFlBQVk7SUFDbEMsTUFBTUMsU0FBU3JCLHNEQUFTQTtJQUN4QixNQUFNc0IsaUJBQWlCeEIsNkNBQU1BLENBQUMsSUFBSTtJQUNsQyxNQUFNeUIsZ0JBQWdCekIsNkNBQU1BLENBQUMsSUFBSTtJQUNqQyxNQUFNMEIsaUJBQWlCMUIsNkNBQU1BLENBQUMsSUFBSTtJQUNsQyxNQUFNMkIsY0FBYzNCLDZDQUFNQSxDQUFDLElBQUk7SUFDL0IsTUFBTSxDQUFDNEIsY0FBY0MsZ0JBQWdCLEdBQUc1QiwrQ0FBUUEsQ0FBQyxJQUFJO0lBQ3JELE1BQU0sQ0FBQzZCLFdBQVdDLGFBQWEsR0FBRzlCLCtDQUFRQSxDQUFDLElBQUk7SUFDL0MsTUFBTSxDQUFDK0Isb0JBQW9CQyxzQkFBc0IsR0FBR2hDLCtDQUFRQSxDQUFDLEtBQUs7SUFDbEUsTUFBTSxDQUFDaUMsUUFBUUMsVUFBVSxHQUFHbEMsK0NBQVFBLENBQUNzQixPQUFPYSxLQUFLLENBQUNDLEVBQUUsRUFBRUM7SUFFdER2QyxnREFBU0EsQ0FBQyxJQUFNO1FBQ2QsTUFBTXdDLFVBQVU7WUFDZEMsWUFBWTtnQkFDVjtvQkFDRUMsTUFBTTt3QkFDSjt3QkFDQTtxQkFDRDtnQkFDSDthQUNEO1lBQ0RDLHNCQUFzQjtRQUN4QjtRQUVBbEIsZUFBZW1CLE9BQU8sR0FBRyxJQUFJQyxrQkFBa0JMO1FBRS9DTSxjQUFjQyxJQUFJLENBQUMsSUFBTTtZQUN2QixJQUFJdkIsT0FBT2EsS0FBSyxDQUFDQyxFQUFFLEVBQUU7Z0JBQ25CVTtZQUNGLENBQUM7UUFDSDtRQUVBLE9BQU8sSUFBTTtZQUNYLGdFQUFnRTtZQUNoRSwyQkFBMkI7WUFDM0IsSUFBSXBCLFlBQVlnQixPQUFPLEVBQUU7Z0JBQ3ZCaEIsWUFBWWdCLE9BQU8sQ0FBQ0ssU0FBUyxHQUFHQyxPQUFPLENBQUMsQ0FBQ0MsUUFBVUEsTUFBTUMsSUFBSTtZQUMvRCxDQUFDO1lBQ0QsaUNBQWlDO1lBQ2pDLElBQUkzQixlQUFlbUIsT0FBTyxFQUFFO2dCQUMxQm5CLGVBQWVtQixPQUFPLENBQUNTLEtBQUs7WUFDOUIsQ0FBQztRQUNIO0lBQ0YsR0FBRyxFQUFFO0lBRUwsc0JBQXNCO0lBQ3RCLE1BQU1QLGNBQWMsVUFBWTtRQUM5QixNQUFNUSxlQUFlLE1BQU1DLFVBQVVDLFlBQVksQ0FBQ0MsWUFBWSxDQUFDO1lBQzdEQyxPQUFPLElBQUk7WUFDWEMsT0FBTyxJQUFJO1FBQ2I7UUFDQSxNQUFNQyxnQkFBZ0IsSUFBSUM7UUFFMUIsbURBQW1EO1FBQ25EUCxhQUFhTCxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxDQUFDQyxRQUFVO1lBQzFDMUIsZUFBZW1CLE9BQU8sQ0FBQ2tCLFFBQVEsQ0FBQ1gsT0FBT0c7UUFDekM7UUFFQSxzREFBc0Q7UUFDdEQ3QixlQUFlbUIsT0FBTyxDQUFDbUIsT0FBTyxHQUFHLENBQUNDLFFBQVU7WUFDMUNBLE1BQU1DLE9BQU8sQ0FBQyxFQUFFLENBQUNoQixTQUFTLEdBQUdDLE9BQU8sQ0FBQyxDQUFDQyxRQUFVO2dCQUM5Q1MsY0FBY0UsUUFBUSxDQUFDWDtnQkFDdkIsSUFBSUEsTUFBTWUsSUFBSSxLQUFLLFNBQVM7b0JBQzFCLHdDQUF3QztvQkFDeENmLE1BQU1nQixNQUFNLEdBQUcsSUFBTTt3QkFDbkJDLFFBQVFDLEdBQUcsQ0FBQzt3QkFDWm5DLHNCQUFzQixLQUFLO29CQUM3QjtvQkFFQWlCLE1BQU1tQixRQUFRLEdBQUcsSUFBTTt3QkFDckJGLFFBQVFDLEdBQUcsQ0FBQzt3QkFDWm5DLHNCQUFzQixJQUFJO29CQUM1QjtnQkFDRixDQUFDO1lBQ0g7UUFDRjtRQUVBUixjQUFja0IsT0FBTyxDQUFDMkIsU0FBUyxHQUFHakI7UUFDbEMzQixlQUFlaUIsT0FBTyxDQUFDMkIsU0FBUyxHQUFHWDtRQUNuQ2hDLFlBQVlnQixPQUFPLEdBQUdVO0lBQ3hCO0lBRUEsTUFBTWtCLG9CQUFvQixJQUFNO1FBQzlCdEMsc0JBQXNCLENBQUNEO0lBQ3pCO0lBRUEsTUFBTXdDLGNBQWMsSUFBTTtRQUN4QixJQUFJL0MsY0FBY2tCLE9BQU8sRUFBRTtZQUN6QixNQUFNOEIsU0FBU2hELGNBQWNrQixPQUFPLENBQUMyQixTQUFTO1lBQzlDLElBQUlHLFFBQVE7Z0JBQ1YsTUFBTUMsY0FBY0QsT0FBT0UsY0FBYztnQkFDekMsSUFBSUQsWUFBWXZELE1BQU0sR0FBRyxHQUFHO29CQUMxQixJQUFJLENBQUNTLGNBQWM7d0JBQ2pCLG9CQUFvQjt3QkFDcEIwQixVQUFVQyxZQUFZLENBQ25CQyxZQUFZLENBQUM7NEJBQUVDLE9BQU8sSUFBSTt3QkFBQyxHQUMzQlgsSUFBSSxDQUFDLENBQUM4QixZQUFjOzRCQUNuQixNQUFNQyxnQkFBZ0JELFVBQVVELGNBQWMsRUFBRSxDQUFDLEVBQUU7NEJBQ25ELE1BQU1HLFNBQVN0RCxlQUFlbUIsT0FBTyxDQUFDb0MsVUFBVSxHQUFHQyxJQUFJLENBQUMsQ0FBQ0MsSUFBTTtnQ0FDN0QsT0FBT0EsRUFBRS9CLEtBQUssSUFBSStCLEVBQUUvQixLQUFLLENBQUNlLElBQUksS0FBSzs0QkFDckM7NEJBQ0FhLE9BQU9JLFlBQVksQ0FBQ0w7NEJBQ3BCSixPQUFPVSxXQUFXLENBQUNULFdBQVcsQ0FBQyxFQUFFOzRCQUNqQ0QsT0FBT1osUUFBUSxDQUFDZ0I7NEJBQ2hCaEQsZ0JBQWdCLElBQUk7d0JBQ3RCLEdBQ0N1RCxLQUFLLENBQUMsQ0FBQ0MsTUFBUWxCLFFBQVFtQixLQUFLLENBQUMsMkJBQTJCRDtvQkFDN0QsT0FBTzt3QkFDTCxvREFBb0Q7d0JBQ3BEWCxXQUFXLENBQUMsRUFBRSxDQUFDdkIsSUFBSTt3QkFDbkJ0QixnQkFBZ0IsS0FBSztvQkFDdkIsQ0FBQztnQkFDSCxDQUFDO1lBQ0gsQ0FBQztRQUNILENBQUM7SUFDSDtJQUVBLE1BQU0wRCxZQUFZLElBQU07UUFDdEJ4RCxhQUFhLENBQUNEO1FBQ2QsSUFBSUwsY0FBY2tCLE9BQU8sRUFBRTtZQUN6QixNQUFNOEIsU0FBU2hELGNBQWNrQixPQUFPLENBQUMyQixTQUFTO1lBQzlDLElBQUlHLFFBQVE7Z0JBQ1YsTUFBTWUsY0FBY2YsT0FBT2dCLGNBQWM7Z0JBQ3pDLElBQUlELFlBQVlyRSxNQUFNLEdBQUcsR0FBRztvQkFDMUJxRSxXQUFXLENBQUMsRUFBRSxDQUFDRSxPQUFPLEdBQUcsQ0FBQ0YsV0FBVyxDQUFDLEVBQUUsQ0FBQ0UsT0FBTztnQkFDbEQsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO0lBQ0g7SUFFQSxrQkFBa0I7SUFDbEIsTUFBTUMsZUFBZSxVQUFZO1FBQy9CLGdEQUFnRDtRQUNoRCxNQUFNQyxVQUFVdkUsVUFBVXdFLFVBQVUsQ0FBQyxTQUFTQyxHQUFHO1FBQ2pELE1BQU1DLGtCQUFrQkgsUUFBUUMsVUFBVSxDQUFDO1FBQzNDLE1BQU1HLG1CQUFtQkosUUFBUUMsVUFBVSxDQUFDO1FBRTVDMUQsVUFBVXlELFFBQVF2RCxFQUFFO1FBQ3BCNEQsZ0JBQWdCTCxRQUFRdkQsRUFBRTtRQUUxQix3Q0FBd0M7UUFDeENiLGVBQWVtQixPQUFPLENBQUN1RCxjQUFjLEdBQUcsQ0FBQ25DLFFBQVU7WUFDakRBLE1BQU1vQyxTQUFTLElBQUlKLGdCQUFnQkssR0FBRyxDQUFDckMsTUFBTW9DLFNBQVMsQ0FBQ0UsTUFBTTtRQUMvRDtRQUVBLGVBQWU7UUFDZixNQUFNQyxtQkFBbUIsTUFBTTlFLGVBQWVtQixPQUFPLENBQUM0RCxXQUFXO1FBQ2pFLE1BQU0vRSxlQUFlbUIsT0FBTyxDQUFDNkQsbUJBQW1CLENBQUNGO1FBRWpELE1BQU1HLFFBQVE7WUFDWkMsS0FBS0osaUJBQWlCSSxHQUFHO1lBQ3pCQyxNQUFNTCxpQkFBaUJLLElBQUk7UUFDN0I7UUFFQSxNQUFNZixRQUFRZ0IsR0FBRyxDQUFDO1lBQUVIO1FBQU07UUFFMUIsMkJBQTJCO1FBQzNCYixRQUFRaUIsVUFBVSxDQUFDLENBQUNDLFdBQWE7WUFDL0IsTUFBTUMsT0FBT0QsU0FBU0MsSUFBSTtZQUMxQixJQUFJLENBQUN2RixlQUFlbUIsT0FBTyxDQUFDcUUsd0JBQXdCLElBQUlELE1BQU1FLFFBQVE7Z0JBQ3BFLE1BQU1DLG9CQUFvQixJQUFJQyxzQkFBc0JKLEtBQUtFLE1BQU07Z0JBQy9EekYsZUFBZW1CLE9BQU8sQ0FBQ3lFLG9CQUFvQixDQUFDRjtZQUM5QyxDQUFDO1FBQ0g7UUFFQSxrREFBa0Q7UUFDbERsQixpQkFBaUJhLFVBQVUsQ0FBQyxDQUFDQyxXQUFhO1lBQ3hDQSxTQUFTTyxVQUFVLEdBQUdwRSxPQUFPLENBQUMsQ0FBQ3FFLFNBQVc7Z0JBQ3hDLElBQUlBLE9BQU9YLElBQUksS0FBSyxTQUFTO29CQUMzQixNQUFNUixZQUFZLElBQUlvQixnQkFBZ0JELE9BQU94QixHQUFHLENBQUNpQixJQUFJO29CQUNyRHZGLGVBQWVtQixPQUFPLENBQUM2RSxlQUFlLENBQUNyQjtnQkFDekMsQ0FBQztZQUNIO1FBQ0Y7SUFDRjtJQUVBLHFDQUFxQztJQUNyQyxNQUFNcEQsV0FBVyxVQUFZO1FBQzNCLE1BQU02QyxVQUFVdkUsVUFBVXdFLFVBQVUsQ0FBQyxTQUFTQyxHQUFHLENBQUM1RDtRQUNsRCxNQUFNOEQsbUJBQW1CSixRQUFRQyxVQUFVLENBQUM7UUFDNUMsTUFBTUUsa0JBQWtCSCxRQUFRQyxVQUFVLENBQUM7UUFFM0NyRSxlQUFlbUIsT0FBTyxDQUFDdUQsY0FBYyxHQUFHLENBQUNuQyxRQUFVO1lBQ2pEQSxNQUFNb0MsU0FBUyxJQUFJSCxpQkFBaUJJLEdBQUcsQ0FBQ3JDLE1BQU1vQyxTQUFTLENBQUNFLE1BQU07UUFDaEU7UUFFQSxNQUFNb0IsV0FBVyxDQUFDLE1BQU03QixRQUFROEIsR0FBRyxFQUFDLEVBQUdYLElBQUk7UUFFM0MsTUFBTVQsbUJBQW1CbUIsU0FBU2hCLEtBQUs7UUFDdkMsTUFBTWpGLGVBQWVtQixPQUFPLENBQUN5RSxvQkFBb0IsQ0FDL0MsSUFBSUQsc0JBQXNCYjtRQUc1QixNQUFNWSxvQkFBb0IsTUFBTTFGLGVBQWVtQixPQUFPLENBQUNnRixZQUFZO1FBQ25FLE1BQU1uRyxlQUFlbUIsT0FBTyxDQUFDNkQsbUJBQW1CLENBQUNVO1FBRWpELE1BQU1ELFNBQVM7WUFDYk4sTUFBTU8sa0JBQWtCUCxJQUFJO1lBQzVCRCxLQUFLUSxrQkFBa0JSLEdBQUc7UUFDNUI7UUFFQSxNQUFNZCxRQUFRZ0MsTUFBTSxDQUFDO1lBQUVYO1FBQU87UUFFOUJsQixnQkFBZ0JjLFVBQVUsQ0FBQyxDQUFDQyxXQUFhO1lBQ3ZDQSxTQUFTTyxVQUFVLEdBQUdwRSxPQUFPLENBQUMsQ0FBQ3FFLFNBQVc7Z0JBQ3hDLElBQUlBLE9BQU9YLElBQUksS0FBSyxTQUFTO29CQUMzQixJQUFJSSxPQUFPTyxPQUFPeEIsR0FBRyxDQUFDaUIsSUFBSTtvQkFDMUJ2RixlQUFlbUIsT0FBTyxDQUFDNkUsZUFBZSxDQUFDLElBQUlELGdCQUFnQlI7Z0JBQzdELENBQUM7WUFDSDtRQUNGO0lBQ0Y7SUFFQSxNQUFNYyxVQUFVLElBQU07UUFDcEJ0RyxPQUFPdUcsSUFBSTtJQUNiO0lBRUEscUJBQ0UsOERBQUNDO1FBQUlDLFdBQVU7O1lBS1p6RyxPQUFPYSxLQUFLLENBQUNDLEVBQUUsR0FBRyxJQUFJLGlCQUNyQiw4REFBQzBGO2dCQUFJQyxXQUFVOzBCQUNiLDRFQUFDQztvQkFDQ0QsV0FBVyxDQUFDLGtFQUFrRSxDQUFDO29CQUMvRUUsU0FBU3ZDOzhCQUNWOzs7Ozs7Ozs7O29CQUlKOzBCQUNELDhEQUFDb0M7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDQzt3QkFDQ0MsU0FBUzNDO3dCQUNUb0IsTUFBSzt3QkFDTHFCLFdBQVU7a0NBRVRsRywwQkFDQyw4REFBQ3FHOzRCQUFJQyxLQUFJOzRCQUFXQyxLQUFJOzRCQUFhTCxXQUFVOzs7OztpREFFL0MsOERBQUNHOzRCQUFJQyxLQUFJOzRCQUFZQyxLQUFJOzRCQUFhTCxXQUFVOzs7OztnQ0FDakQ7Ozs7OztrQ0FFSCw4REFBQ0M7d0JBQ0NDLFNBQVNMO3dCQUNUbEIsTUFBSzt3QkFDTHFCLFdBQVU7a0NBRVYsNEVBQUNHOzRCQUFJQyxLQUFJOzRCQUFjQyxLQUFJOzRCQUFhTCxXQUFVOzs7Ozs7Ozs7OztrQ0FFcEQsOERBQUNDO3dCQUNDQyxTQUFTMUQ7d0JBQ1RtQyxNQUFLO3dCQUNMcUIsV0FBVTtrQ0FFVHBHLDZCQUNDLDhEQUFDdUc7NEJBQ0NDLEtBQUk7NEJBQ0pDLEtBQUk7NEJBQ0pMLFdBQVU7Ozs7O2lEQUdaLDhEQUFDRzs0QkFDQ0MsS0FBSTs0QkFDSkMsS0FBSTs0QkFDSkwsV0FBVTs7Ozs7Z0NBRWI7Ozs7Ozs7Ozs7OzswQkFHTCw4REFBQ3ZFO2dCQUNDNkUsUUFBUTtnQkFDUkMsS0FBSztnQkFDTEMsS0FBSy9HO2dCQUNMdUcsV0FDRXBHLGVBQ0ksMkRBQ0EsUUFBUTs7Ozs7O1lBR2YsQ0FBQ0EsOEJBQ0EsOERBQUNtRztnQkFBSUMsV0FBVTswQkFDYiw0RUFBQ0c7b0JBQUlDLEtBQUk7b0JBQVdDLEtBQUk7b0JBQWFMLFdBQVU7Ozs7Ozs7Ozs7OzBCQUluRCw4REFBQ0Q7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDdkU7d0JBQ0M2RSxRQUFRO3dCQUNSRSxLQUFLOUc7d0JBQ0xzRyxXQUFXLENBQUMsa0VBQWtFLEVBQzVFaEcscUJBQXFCLEtBQUssUUFBUSxDQUNuQyxDQUFDOzs7Ozs7a0NBRUosOERBQUNtRzt3QkFDQ0MsS0FBSTt3QkFDSkMsS0FBSTt3QkFDSkwsV0FBVyxDQUFDLGtCQUFrQixFQUFFaEcscUJBQXFCLFdBQVcsRUFBRSxDQUFDLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUs5RSxDQUFDO0FBRUQsU0FBU2lFLGdCQUFnQndDLElBQUksRUFBRTtJQUM3Qm5GLFVBQVVvRixTQUFTLENBQUNDLFNBQVMsQ0FBQ0YsTUFBTTNGLElBQUksQ0FDdEMsV0FBWTtRQUNWOEYsTUFBTTtJQUNSLEdBQ0EsU0FBVXZELEdBQUcsRUFBRTtRQUNidUQsTUFBTTtJQUNSO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaXJjbGUtbWVldHMvLi9wYWdlcy92aWRlby1jYWxsL2luZGV4LnRzeD82NmI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJbWFnZSBmcm9tIFwibmV4dC9pbWFnZVwiO1xuaW1wb3J0IGZpcmViYXNlIGZyb20gXCJmaXJlYmFzZS9hcHBcIjtcbmltcG9ydCBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tIFwibmV4dC9yb3V0ZXJcIjtcblxuY29uc3QgZmlyZWJhc2VDb25maWcgPSB7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX0tFWSxcbiAgYXV0aERvbWFpbjogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVVUSF9ET01BSU4sXG4gIHByb2plY3RJZDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfUFJPSkVDVF9JRCxcbiAgc3RvcmFnZUJ1Y2tldDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1RPUkFHRV9CVUNLRVQsXG4gIG1lc3NhZ2luZ1NlbmRlcklkOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19NRVNTQUdJTkdfU0VOREVSX0lELFxuICBhcHBJZDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX0lELFxufTtcblxuaWYgKCFmaXJlYmFzZS5hcHBzLmxlbmd0aCkge1xuICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcbn1cbmNvbnN0IGZpcmVzdG9yZSA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBWaWRlb0NhbGwoKSB7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuICBjb25zdCBwZWVyQ29ubmVjdGlvbiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgbG9jYWxWaWRlb1JlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3QgcmVtb3RlVmlkZW9SZWYgPSB1c2VSZWYobnVsbCk7XG4gIGNvbnN0IGxvY2FsU3RyZWFtID0gdXNlUmVmKG51bGwpO1xuICBjb25zdCBbY2FtZXJhQWN0aXZlLCBzZXRDYW1lcmFBY3RpdmVdID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFttaWNBY3RpdmUsIHNldE1pY0FjdGl2ZV0gPSB1c2VTdGF0ZSh0cnVlKTtcbiAgY29uc3QgW3JlbW90ZUNhbWVyYUFjdGl2ZSwgc2V0UmVtb3RlQ2FtZXJhQWN0aXZlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NhbGxJZCwgc2V0Q2FsbElkXSA9IHVzZVN0YXRlKHJvdXRlci5xdWVyeS5pZD8udG9TdHJpbmcoKSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBzZXJ2ZXJzID0ge1xuICAgICAgaWNlU2VydmVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgdXJsczogW1xuICAgICAgICAgICAgXCJzdHVuOnN0dW4xLmwuZ29vZ2xlLmNvbToxOTMwMlwiLFxuICAgICAgICAgICAgXCJzdHVuOnN0dW4yLmwuZ29vZ2xlLmNvbToxOTMwMlwiLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgaWNlQ2FuZGlkYXRlUG9vbFNpemU6IDEwLFxuICAgIH07XG5cbiAgICBwZWVyQ29ubmVjdGlvbi5jdXJyZW50ID0gbmV3IFJUQ1BlZXJDb25uZWN0aW9uKHNlcnZlcnMpO1xuXG4gICAgc3RhcnRXZWJjYW0oKS50aGVuKCgpID0+IHtcbiAgICAgIGlmIChyb3V0ZXIucXVlcnkuaWQpIHtcbiAgICAgICAgam9pbkNhbGwoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAvLyBDbGVhbnVwIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBjb21wb25lbnQgaXMgdW5tb3VudGVkXG4gICAgICAvLyAxLiBTdG9wIGFsbCBtZWRpYSB0cmFja3NcbiAgICAgIGlmIChsb2NhbFN0cmVhbS5jdXJyZW50KSB7XG4gICAgICAgIGxvY2FsU3RyZWFtLmN1cnJlbnQuZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHRyYWNrLnN0b3AoKSk7XG4gICAgICB9XG4gICAgICAvLyAyLiBDbG9zZSB0aGUgUlRDUGVlckNvbm5lY3Rpb25cbiAgICAgIGlmIChwZWVyQ29ubmVjdGlvbi5jdXJyZW50KSB7XG4gICAgICAgIHBlZXJDb25uZWN0aW9uLmN1cnJlbnQuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbXSk7XG5cbiAgLy8gU2V0dXAgbWVkaWEgc291cmNlc1xuICBjb25zdCBzdGFydFdlYmNhbSA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBfbG9jYWxTdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7XG4gICAgICB2aWRlbzogdHJ1ZSxcbiAgICAgIGF1ZGlvOiB0cnVlLFxuICAgIH0pO1xuICAgIGNvbnN0IF9yZW1vdGVTdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTtcblxuICAgIC8vIFB1c2ggdHJhY2tzIGZyb20gbG9jYWwgc3RyZWFtIHRvIHBlZXIgY29ubmVjdGlvblxuICAgIF9sb2NhbFN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgcGVlckNvbm5lY3Rpb24uY3VycmVudC5hZGRUcmFjayh0cmFjaywgX2xvY2FsU3RyZWFtKTtcbiAgICB9KTtcblxuICAgIC8vIFB1bGwgdHJhY2tzIGZyb20gcmVtb3RlIHN0cmVhbSwgYWRkIHRvIHZpZGVvIHN0cmVhbVxuICAgIHBlZXJDb25uZWN0aW9uLmN1cnJlbnQub250cmFjayA9IChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RyZWFtc1swXS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgICBfcmVtb3RlU3RyZWFtLmFkZFRyYWNrKHRyYWNrKTtcbiAgICAgICAgaWYgKHRyYWNrLmtpbmQgPT09IFwidmlkZW9cIikge1xuICAgICAgICAgIC8vIEhhbmRsZSB2aWRlbyB0cmFjayBtdXRlL3VubXV0ZSBldmVudHNcbiAgICAgICAgICB0cmFjay5vbm11dGUgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW90ZSBwZWVyIHN0b3BwZWQgdGhlaXIgdmlkZW9cIik7XG4gICAgICAgICAgICBzZXRSZW1vdGVDYW1lcmFBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB0cmFjay5vbnVubXV0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3RlIHBlZXIgcmVzdGFydGVkIHRoZWlyIHZpZGVvXCIpO1xuICAgICAgICAgICAgc2V0UmVtb3RlQ2FtZXJhQWN0aXZlKHRydWUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBsb2NhbFZpZGVvUmVmLmN1cnJlbnQuc3JjT2JqZWN0ID0gX2xvY2FsU3RyZWFtO1xuICAgIHJlbW90ZVZpZGVvUmVmLmN1cnJlbnQuc3JjT2JqZWN0ID0gX3JlbW90ZVN0cmVhbTtcbiAgICBsb2NhbFN0cmVhbS5jdXJyZW50ID0gX2xvY2FsU3RyZWFtO1xuICB9O1xuXG4gIGNvbnN0IHRvZ2dsZVJlbW90ZVZpZGVvID0gKCkgPT4ge1xuICAgIHNldFJlbW90ZUNhbWVyYUFjdGl2ZSghcmVtb3RlQ2FtZXJhQWN0aXZlKTtcbiAgfTtcblxuICBjb25zdCB0b2dnbGVWaWRlbyA9ICgpID0+IHtcbiAgICBpZiAobG9jYWxWaWRlb1JlZi5jdXJyZW50KSB7XG4gICAgICBjb25zdCBzdHJlYW0gPSBsb2NhbFZpZGVvUmVmLmN1cnJlbnQuc3JjT2JqZWN0O1xuICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICBjb25zdCB2aWRlb1RyYWNrcyA9IHN0cmVhbS5nZXRWaWRlb1RyYWNrcygpO1xuICAgICAgICBpZiAodmlkZW9UcmFja3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGlmICghY2FtZXJhQWN0aXZlKSB7XG4gICAgICAgICAgICAvLyBSZXN0YXJ0IHRoZSB2aWRlb1xuICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlc1xuICAgICAgICAgICAgICAuZ2V0VXNlck1lZGlhKHsgdmlkZW86IHRydWUgfSlcbiAgICAgICAgICAgICAgLnRoZW4oKG5ld1N0cmVhbSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZpZGVvVHJhY2sgPSBuZXdTdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZW5kZXIgPSBwZWVyQ29ubmVjdGlvbi5jdXJyZW50LmdldFNlbmRlcnMoKS5maW5kKChzKSA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcy50cmFjayAmJiBzLnRyYWNrLmtpbmQgPT09IFwidmlkZW9cIjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBzZW5kZXIucmVwbGFjZVRyYWNrKG5ld1ZpZGVvVHJhY2spO1xuICAgICAgICAgICAgICAgIHN0cmVhbS5yZW1vdmVUcmFjayh2aWRlb1RyYWNrc1swXSk7XG4gICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKG5ld1ZpZGVvVHJhY2spO1xuICAgICAgICAgICAgICAgIHNldENhbWVyYUFjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZXN0YXJ0aW5nIHZpZGVvOlwiLCBlcnIpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU3RvcCB0aGUgdmlkZW8gYW5kIHRoZSBjb25uZWN0aW9uIHdpdGggdGhlIGNhbWVyYVxuICAgICAgICAgICAgdmlkZW9UcmFja3NbMF0uc3RvcCgpO1xuICAgICAgICAgICAgc2V0Q2FtZXJhQWN0aXZlKGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgdG9nZ2xlTWljID0gKCkgPT4ge1xuICAgIHNldE1pY0FjdGl2ZSghbWljQWN0aXZlKTtcbiAgICBpZiAobG9jYWxWaWRlb1JlZi5jdXJyZW50KSB7XG4gICAgICBjb25zdCBzdHJlYW0gPSBsb2NhbFZpZGVvUmVmLmN1cnJlbnQuc3JjT2JqZWN0O1xuICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICBjb25zdCBhdWRpb1RyYWNrcyA9IHN0cmVhbS5nZXRBdWRpb1RyYWNrcygpO1xuICAgICAgICBpZiAoYXVkaW9UcmFja3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGF1ZGlvVHJhY2tzWzBdLmVuYWJsZWQgPSAhYXVkaW9UcmFja3NbMF0uZW5hYmxlZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBDcmVhdGUgYW4gb2ZmZXJcbiAgY29uc3QgY3JlYXRlQ2FsbElkID0gYXN5bmMgKCkgPT4ge1xuICAgIC8vIFJlZmVyZW5jZSBGaXJlc3RvcmUgY29sbGVjdGlvbnMgZm9yIHNpZ25hbGluZ1xuICAgIGNvbnN0IGNhbGxEb2MgPSBmaXJlc3RvcmUuY29sbGVjdGlvbihcImNhbGxzXCIpLmRvYygpO1xuICAgIGNvbnN0IG9mZmVyQ2FuZGlkYXRlcyA9IGNhbGxEb2MuY29sbGVjdGlvbihcIm9mZmVyQ2FuZGlkYXRlc1wiKTtcbiAgICBjb25zdCBhbnN3ZXJDYW5kaWRhdGVzID0gY2FsbERvYy5jb2xsZWN0aW9uKFwiYW5zd2VyQ2FuZGlkYXRlc1wiKTtcblxuICAgIHNldENhbGxJZChjYWxsRG9jLmlkKTtcbiAgICBjb3B5VG9DbGlwYm9hcmQoY2FsbERvYy5pZCk7XG5cbiAgICAvLyBHZXQgY2FuZGlkYXRlcyBmb3IgY2FsbGVyLCBzYXZlIHRvIGRiXG4gICAgcGVlckNvbm5lY3Rpb24uY3VycmVudC5vbmljZWNhbmRpZGF0ZSA9IChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuY2FuZGlkYXRlICYmIG9mZmVyQ2FuZGlkYXRlcy5hZGQoZXZlbnQuY2FuZGlkYXRlLnRvSlNPTigpKTtcbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIG9mZmVyXG4gICAgY29uc3Qgb2ZmZXJEZXNjcmlwdGlvbiA9IGF3YWl0IHBlZXJDb25uZWN0aW9uLmN1cnJlbnQuY3JlYXRlT2ZmZXIoKTtcbiAgICBhd2FpdCBwZWVyQ29ubmVjdGlvbi5jdXJyZW50LnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXJEZXNjcmlwdGlvbik7XG5cbiAgICBjb25zdCBvZmZlciA9IHtcbiAgICAgIHNkcDogb2ZmZXJEZXNjcmlwdGlvbi5zZHAsXG4gICAgICB0eXBlOiBvZmZlckRlc2NyaXB0aW9uLnR5cGUsXG4gICAgfTtcblxuICAgIGF3YWl0IGNhbGxEb2Muc2V0KHsgb2ZmZXIgfSk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIHJlbW90ZSBhbnN3ZXJcbiAgICBjYWxsRG9jLm9uU25hcHNob3QoKHNuYXBzaG90KSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0gc25hcHNob3QuZGF0YSgpO1xuICAgICAgaWYgKCFwZWVyQ29ubmVjdGlvbi5jdXJyZW50LmN1cnJlbnRSZW1vdGVEZXNjcmlwdGlvbiAmJiBkYXRhPy5hbnN3ZXIpIHtcbiAgICAgICAgY29uc3QgYW5zd2VyRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEuYW5zd2VyKTtcbiAgICAgICAgcGVlckNvbm5lY3Rpb24uY3VycmVudC5zZXRSZW1vdGVEZXNjcmlwdGlvbihhbnN3ZXJEZXNjcmlwdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBXaGVuIGFuc3dlcmVkLCBhZGQgY2FuZGlkYXRlIHRvIHBlZXIgY29ubmVjdGlvblxuICAgIGFuc3dlckNhbmRpZGF0ZXMub25TbmFwc2hvdCgoc25hcHNob3QpID0+IHtcbiAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKChjaGFuZ2UpID0+IHtcbiAgICAgICAgaWYgKGNoYW5nZS50eXBlID09PSBcImFkZGVkXCIpIHtcbiAgICAgICAgICBjb25zdCBjYW5kaWRhdGUgPSBuZXcgUlRDSWNlQ2FuZGlkYXRlKGNoYW5nZS5kb2MuZGF0YSgpKTtcbiAgICAgICAgICBwZWVyQ29ubmVjdGlvbi5jdXJyZW50LmFkZEljZUNhbmRpZGF0ZShjYW5kaWRhdGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBBbnN3ZXIgdGhlIGNhbGwgd2l0aCB0aGUgdW5pcXVlIGlkXG4gIGNvbnN0IGpvaW5DYWxsID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNhbGxEb2MgPSBmaXJlc3RvcmUuY29sbGVjdGlvbihcImNhbGxzXCIpLmRvYyhjYWxsSWQpO1xuICAgIGNvbnN0IGFuc3dlckNhbmRpZGF0ZXMgPSBjYWxsRG9jLmNvbGxlY3Rpb24oXCJhbnN3ZXJDYW5kaWRhdGVzXCIpO1xuICAgIGNvbnN0IG9mZmVyQ2FuZGlkYXRlcyA9IGNhbGxEb2MuY29sbGVjdGlvbihcIm9mZmVyQ2FuZGlkYXRlc1wiKTtcblxuICAgIHBlZXJDb25uZWN0aW9uLmN1cnJlbnQub25pY2VjYW5kaWRhdGUgPSAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LmNhbmRpZGF0ZSAmJiBhbnN3ZXJDYW5kaWRhdGVzLmFkZChldmVudC5jYW5kaWRhdGUudG9KU09OKCkpO1xuICAgIH07XG5cbiAgICBjb25zdCBjYWxsRGF0YSA9IChhd2FpdCBjYWxsRG9jLmdldCgpKS5kYXRhKCk7XG5cbiAgICBjb25zdCBvZmZlckRlc2NyaXB0aW9uID0gY2FsbERhdGEub2ZmZXI7XG4gICAgYXdhaXQgcGVlckNvbm5lY3Rpb24uY3VycmVudC5zZXRSZW1vdGVEZXNjcmlwdGlvbihcbiAgICAgIG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24ob2ZmZXJEZXNjcmlwdGlvbilcbiAgICApO1xuXG4gICAgY29uc3QgYW5zd2VyRGVzY3JpcHRpb24gPSBhd2FpdCBwZWVyQ29ubmVjdGlvbi5jdXJyZW50LmNyZWF0ZUFuc3dlcigpO1xuICAgIGF3YWl0IHBlZXJDb25uZWN0aW9uLmN1cnJlbnQuc2V0TG9jYWxEZXNjcmlwdGlvbihhbnN3ZXJEZXNjcmlwdGlvbik7XG5cbiAgICBjb25zdCBhbnN3ZXIgPSB7XG4gICAgICB0eXBlOiBhbnN3ZXJEZXNjcmlwdGlvbi50eXBlLFxuICAgICAgc2RwOiBhbnN3ZXJEZXNjcmlwdGlvbi5zZHAsXG4gICAgfTtcblxuICAgIGF3YWl0IGNhbGxEb2MudXBkYXRlKHsgYW5zd2VyIH0pO1xuXG4gICAgb2ZmZXJDYW5kaWRhdGVzLm9uU25hcHNob3QoKHNuYXBzaG90KSA9PiB7XG4gICAgICBzbmFwc2hvdC5kb2NDaGFuZ2VzKCkuZm9yRWFjaCgoY2hhbmdlKSA9PiB7XG4gICAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gXCJhZGRlZFwiKSB7XG4gICAgICAgICAgbGV0IGRhdGEgPSBjaGFuZ2UuZG9jLmRhdGEoKTtcbiAgICAgICAgICBwZWVyQ29ubmVjdGlvbi5jdXJyZW50LmFkZEljZUNhbmRpZGF0ZShuZXcgUlRDSWNlQ2FuZGlkYXRlKGRhdGEpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgZW5kQ2FsbCA9ICgpID0+IHtcbiAgICByb3V0ZXIuYmFjaygpO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJ3aGl0ZS1ncmlkIGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyXCI+XG4gICAgICB7LyogVE9ETzogSW1wbGVtZW50IG5hbWUgc2hhcmluZyBiZXR3ZWVuIHBlZXJzICovfVxuICAgICAgey8qIDxoMiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBmb250LWRtIHRleHQtY29tbXVuaXhQdXJwbGUgbGVmdC01IHRleHQtM3hsXCI+XG4gICAgICAgICAge25hbWV9XG4gICAgICAgIDwvaDI+ICovfVxuICAgICAge3JvdXRlci5xdWVyeS5pZCA/IG51bGwgOiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBnYXAtMiBtdC00XCI+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgY2xhc3NOYW1lPXtgYm9yZGVyLTIgYm9yZGVyLWNvbW11bml4UHVycGxlIHJvdW5kZWQtbWQgYmctY29tbXVuaXhSZWQgcHktMiBweC00YH1cbiAgICAgICAgICAgIG9uQ2xpY2s9e2NyZWF0ZUNhbGxJZH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICBDb3B5IGNhbGwgSURcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGp1c3RpZnktZW5kIHJlbGF0aXZlIGxlZnQtODAgdG9wLTMyIGdhcC0xXCI+XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICBvbkNsaWNrPXt0b2dnbGVNaWN9XG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgY2xhc3NOYW1lPVwiYm9yZGVyLTIgYm9yZGVyLWNvbW11bml4UHVycGxlIHJvdW5kZWQtbWQgYmctY29tbXVuaXhSZWRcIlxuICAgICAgICA+XG4gICAgICAgICAge21pY0FjdGl2ZSA/IChcbiAgICAgICAgICAgIDxpbWcgc3JjPVwiL21pYy5wbmdcIiBhbHQ9XCJ0b2dnbGUgbWljXCIgY2xhc3NOYW1lPVwiaC04IHAtMiBweS0xXCIgLz5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPGltZyBzcmM9XCIvbXV0ZS5wbmdcIiBhbHQ9XCJ0b2dnbGUgbWljXCIgY2xhc3NOYW1lPVwiaC04IHAtMiBweS0xXCIgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIG9uQ2xpY2s9e2VuZENhbGx9XG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgY2xhc3NOYW1lPVwiYm9yZGVyLTIgYm9yZGVyLWNvbW11bml4UHVycGxlIHJvdW5kZWQtbWQgYmctY29tbXVuaXhSZWRcIlxuICAgICAgICA+XG4gICAgICAgICAgPGltZyBzcmM9XCIvbG9nb3V0LnBuZ1wiIGFsdD1cImxlYXZlIGNoYXRcIiBjbGFzc05hbWU9XCJoLTggcC0yIHB5LTFcIiAvPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIG9uQ2xpY2s9e3RvZ2dsZVZpZGVvfVxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgIGNsYXNzTmFtZT1cImJvcmRlci0yIGJvcmRlci1jb21tdW5peFB1cnBsZSByb3VuZGVkLW1kIGJnLWNvbW11bml4UmVkXCJcbiAgICAgICAgPlxuICAgICAgICAgIHtjYW1lcmFBY3RpdmUgPyAoXG4gICAgICAgICAgICA8aW1nXG4gICAgICAgICAgICAgIHNyYz1cIi92aWRlby1jYW1lcmEucG5nXCJcbiAgICAgICAgICAgICAgYWx0PVwidG9nZ2xlIGNhbWVyYVwiXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImgtOCBwLTIgcHktMVwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8aW1nXG4gICAgICAgICAgICAgIHNyYz1cIi9uby12aWRlby5wbmdcIlxuICAgICAgICAgICAgICBhbHQ9XCJ0b2dnbGUgY2FtZXJhXCJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaC04IHAtMiBweS0xXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICAgIDx2aWRlb1xuICAgICAgICBhdXRvUGxheVxuICAgICAgICBtdXRlZFxuICAgICAgICByZWY9e2xvY2FsVmlkZW9SZWZ9XG4gICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgY2FtZXJhQWN0aXZlXG4gICAgICAgICAgICA/IFwiYmctd2hpdGUgYm9yZGVyLTIgYm9yZGVyLWNvbW11bml4UmVkIGgtODAgYXNwZWN0LXZpZGVvXCJcbiAgICAgICAgICAgIDogXCJoaWRkZW5cIlxuICAgICAgICB9XG4gICAgICAvPlxuICAgICAgeyFjYW1lcmFBY3RpdmUgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXdoaXRlIGZsZXggZmxleC1jb2wganVzdGlmeS1lbmQgaXRlbXMtY2VudGVyIGJvcmRlci0yIGJvcmRlci1jb21tdW5peFJlZCBoLTgwIGFzcGVjdC12aWRlb1wiPlxuICAgICAgICAgIDxpbWcgc3JjPVwiL3NoeS5wbmdcIiBhbHQ9XCJzaHkgcGVyc29uXCIgY2xhc3NOYW1lPVwiaC03MlwiIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJoLTgwIGFzcGVjdC12aWRlbyBiZy1jb21tdW5peEdyZWVuIGJvcmRlci0yIGJvcmRlci1jb21tdW5peFB1cnBsZSBmbGV4IGp1c3RpZnktY2VudGVyIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICA8dmlkZW9cbiAgICAgICAgICBhdXRvUGxheVxuICAgICAgICAgIHJlZj17cmVtb3RlVmlkZW9SZWZ9XG4gICAgICAgICAgY2xhc3NOYW1lPXtgaC04MCBhc3BlY3QtdmlkZW8gYmctY29tbXVuaXhHcmVlbiBib3JkZXItMiBib3JkZXItY29tbXVuaXhQdXJwbGUgJHtcbiAgICAgICAgICAgIHJlbW90ZUNhbWVyYUFjdGl2ZSA/IFwiXCIgOiBcImhpZGRlblwiXG4gICAgICAgICAgfWB9XG4gICAgICAgIC8+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICBzcmM9XCIvc2h5Mi5wbmdcIlxuICAgICAgICAgIGFsdD1cInlvdXIgcGFydG5lciBpcyBzaHkgdG9vXCJcbiAgICAgICAgICBjbGFzc05hbWU9e2BoLTcyIHJvdW5kZWQtZnVsbCAke3JlbW90ZUNhbWVyYUFjdGl2ZSA/IFwiaGlkZGVuXCIgOiBcIlwifWB9XG4gICAgICAgIC8+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuZnVuY3Rpb24gY29weVRvQ2xpcGJvYXJkKHRleHQpIHtcbiAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGV4dCkudGhlbihcbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICBhbGVydChcIklkIHdhcyBjb3BpZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIGFsZXJ0KFwiRXJyb3I6IENvdWxkIG5vdCBjb3B5IGlkXCIpO1xuICAgIH1cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJmaXJlYmFzZSIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwidXNlUm91dGVyIiwiZmlyZWJhc2VDb25maWciLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBJX0tFWSIsImF1dGhEb21haW4iLCJORVhUX1BVQkxJQ19BVVRIX0RPTUFJTiIsInByb2plY3RJZCIsIk5FWFRfUFVCTElDX1BST0pFQ1RfSUQiLCJzdG9yYWdlQnVja2V0IiwiTkVYVF9QVUJMSUNfU1RPUkFHRV9CVUNLRVQiLCJtZXNzYWdpbmdTZW5kZXJJZCIsIk5FWFRfUFVCTElDX01FU1NBR0lOR19TRU5ERVJfSUQiLCJhcHBJZCIsIk5FWFRfUFVCTElDX0FQUF9JRCIsImFwcHMiLCJsZW5ndGgiLCJpbml0aWFsaXplQXBwIiwiZmlyZXN0b3JlIiwiVmlkZW9DYWxsIiwicm91dGVyIiwicGVlckNvbm5lY3Rpb24iLCJsb2NhbFZpZGVvUmVmIiwicmVtb3RlVmlkZW9SZWYiLCJsb2NhbFN0cmVhbSIsImNhbWVyYUFjdGl2ZSIsInNldENhbWVyYUFjdGl2ZSIsIm1pY0FjdGl2ZSIsInNldE1pY0FjdGl2ZSIsInJlbW90ZUNhbWVyYUFjdGl2ZSIsInNldFJlbW90ZUNhbWVyYUFjdGl2ZSIsImNhbGxJZCIsInNldENhbGxJZCIsInF1ZXJ5IiwiaWQiLCJ0b1N0cmluZyIsInNlcnZlcnMiLCJpY2VTZXJ2ZXJzIiwidXJscyIsImljZUNhbmRpZGF0ZVBvb2xTaXplIiwiY3VycmVudCIsIlJUQ1BlZXJDb25uZWN0aW9uIiwic3RhcnRXZWJjYW0iLCJ0aGVuIiwiam9pbkNhbGwiLCJnZXRUcmFja3MiLCJmb3JFYWNoIiwidHJhY2siLCJzdG9wIiwiY2xvc2UiLCJfbG9jYWxTdHJlYW0iLCJuYXZpZ2F0b3IiLCJtZWRpYURldmljZXMiLCJnZXRVc2VyTWVkaWEiLCJ2aWRlbyIsImF1ZGlvIiwiX3JlbW90ZVN0cmVhbSIsIk1lZGlhU3RyZWFtIiwiYWRkVHJhY2siLCJvbnRyYWNrIiwiZXZlbnQiLCJzdHJlYW1zIiwia2luZCIsIm9ubXV0ZSIsImNvbnNvbGUiLCJsb2ciLCJvbnVubXV0ZSIsInNyY09iamVjdCIsInRvZ2dsZVJlbW90ZVZpZGVvIiwidG9nZ2xlVmlkZW8iLCJzdHJlYW0iLCJ2aWRlb1RyYWNrcyIsImdldFZpZGVvVHJhY2tzIiwibmV3U3RyZWFtIiwibmV3VmlkZW9UcmFjayIsInNlbmRlciIsImdldFNlbmRlcnMiLCJmaW5kIiwicyIsInJlcGxhY2VUcmFjayIsInJlbW92ZVRyYWNrIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsInRvZ2dsZU1pYyIsImF1ZGlvVHJhY2tzIiwiZ2V0QXVkaW9UcmFja3MiLCJlbmFibGVkIiwiY3JlYXRlQ2FsbElkIiwiY2FsbERvYyIsImNvbGxlY3Rpb24iLCJkb2MiLCJvZmZlckNhbmRpZGF0ZXMiLCJhbnN3ZXJDYW5kaWRhdGVzIiwiY29weVRvQ2xpcGJvYXJkIiwib25pY2VjYW5kaWRhdGUiLCJjYW5kaWRhdGUiLCJhZGQiLCJ0b0pTT04iLCJvZmZlckRlc2NyaXB0aW9uIiwiY3JlYXRlT2ZmZXIiLCJzZXRMb2NhbERlc2NyaXB0aW9uIiwib2ZmZXIiLCJzZHAiLCJ0eXBlIiwic2V0Iiwib25TbmFwc2hvdCIsInNuYXBzaG90IiwiZGF0YSIsImN1cnJlbnRSZW1vdGVEZXNjcmlwdGlvbiIsImFuc3dlciIsImFuc3dlckRlc2NyaXB0aW9uIiwiUlRDU2Vzc2lvbkRlc2NyaXB0aW9uIiwic2V0UmVtb3RlRGVzY3JpcHRpb24iLCJkb2NDaGFuZ2VzIiwiY2hhbmdlIiwiUlRDSWNlQ2FuZGlkYXRlIiwiYWRkSWNlQ2FuZGlkYXRlIiwiY2FsbERhdGEiLCJnZXQiLCJjcmVhdGVBbnN3ZXIiLCJ1cGRhdGUiLCJlbmRDYWxsIiwiYmFjayIsImRpdiIsImNsYXNzTmFtZSIsImJ1dHRvbiIsIm9uQ2xpY2siLCJpbWciLCJzcmMiLCJhbHQiLCJhdXRvUGxheSIsIm11dGVkIiwicmVmIiwidGV4dCIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./pages/video-call/index.tsx\n");

/***/ }),

/***/ "firebase/app":
/*!*******************************!*\
  !*** external "firebase/app" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("firebase/app");

/***/ }),

/***/ "firebase/firestore":
/*!*************************************!*\
  !*** external "firebase/firestore" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("firebase/firestore");

/***/ }),

/***/ "next/router":
/*!******************************!*\
  !*** external "next/router" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("next/router");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

module.exports = require("react");

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("react/jsx-dev-runtime");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/video-call/index.tsx"));
module.exports = __webpack_exports__;

})();